[{"path":"/articles/Example in the paper.html","id":"nbfvis","dir":"Articles","previous_headings":"","what":"NBFvis","title":"","text":"Dimensionality reduction spatial omic data can reveal shared, spatially structured patterns expression across collection genomic features. study strategies discovering interactively visualizing low-dimensional structure spatial omic data based construction neighborhood features. design quantile network-based spatial features result spatially consistent embeddings. simulation compares embeddings made without neighborhood-based featurization, re-analysis [Keren et al., 2019] illustrates overall workflow. provide R package, NBFvis, support computation interactive visualization proposed dimensionality reduction approach.","code":""},{"path":"/articles/Example in the paper.html","id":"installation","dir":"Articles","previous_headings":"NBFvis","what":"Installation","title":"","text":"can install released version NBFvis GitHub.","code":"devtools::install_github(\"XTH1114/NBFvis\")"},{"path":"/articles/Example in the paper.html","id":"example","dir":"Articles","previous_headings":"NBFvis","what":"Example","title":"","text":"example reproduces analysis paper. first load packages dataset need. dataset patient4 6643 × 59 data frame cells tissue section Patient 4 TNBC data [Keren et al., 2019]. added two columns named x center y center, coordinates calculated cell centers spatial raster data. select 41 variables dsDNA HLA Class 1, proteins cell type markers. quantile matrix function generates quantile matrix cell’s neighborhood. function network matrix first builds network inside neighborhood calculates corresponding network statistics using argument given fun. example, use function centralities, also exported package. scales two matrix , means rescaling needed. remove Column, index n neighborhood quantile matrix columns left quantile network variables. Normalization centering applied centralities matrix similar scale quantile matrix. combine quantile matrix rescaled network matrix construct extended featurization matrix, called neighborhood matrix earlier. final step input neighborhood matrix, cell dataset patient4, names variable interest function NBFvis. returns interactive Shiny app source figures Section 5.","code":"library(testpackage) library(dplyr) data(patient4) Quantiles_patient4 <- quantiles_matrix(   data = patient4 %>% select(dsDNA:HLA_Class_1),   coordinate = patient4 %>% select(x_center,y_center),   index = patient4$index,   NN = 40,   distance = 60,   min_percentile = 0.1,   max_percentile = 0.9,   quantile_number = 17,   method = pca_) centrality_patient4 <- network_matrix(   coordinate = patient4 %>% select(ends_with(\"_center\")),   index = patient4$index,   radius = 60,   NN = 40,   edge = 30,   fun = centralities,   length_output = 29,   name_output = NULL) neighborhood_info_patient4 <- cbind(   Quantiles_patient4 %>% select(-index, -n_neighbor),   scale(centrality_patient4 %>% select(-index))) NBF_vis(   matrix = neighborhood_info_patient4,   origin_data = patient4,   var_names = colnames(patient4)[17:57])"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Tinghui Xu. Author, maintainer, thesis advisor. Kris Sankaran. Author, maintainer, thesis advisor.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Xu T, Sankaran K (2022). NBFvis: Visualization Neighborhood-Based Features. R package version 1.0.0.","code":"@Manual{,   title = {NBFvis: Visualization of Neighborhood-Based Features},   author = {Tinghui Xu and Kris Sankaran},   year = {2022},   note = {R package version 1.0.0}, }"},{"path":"/index.html","id":"nbfvis","dir":"","previous_headings":"","what":"Visualization of Neighborhood-Based Features","title":"Visualization of Neighborhood-Based Features","text":"R package Neighborhood-Based Featurization visualizaion Tinghui Xu Kris Sankaran.","code":""},{"path":"/reference/NBF_vis.html","id":null,"dir":"Reference","previous_headings":"","what":"Neighborhood-Based Featurization Visualization — NBF_vis","title":"Neighborhood-Based Featurization Visualization — NBF_vis","text":"function apply UMAP featurization matrix special omics dataset.  matrix neighborhood matrix, combination quantile  matrix network matrix (quantile_matrix network_matrix, respectively)  , shiny app visualize UMAP embeddings spatial omics data.","code":""},{"path":"/reference/NBF_vis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Neighborhood-Based Featurization Visualization — NBF_vis","text":"","code":"NBF_vis(matrix, origin_data, var_names)"},{"path":"/reference/NBF_vis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Neighborhood-Based Featurization Visualization — NBF_vis","text":"matrix statistics matrix. rescaled.  example, rescaled quantiles network centralities matrix. origin_data data frame. origin dataset cell expressions, like proteins genes.  Column index, Group, x_center y_center included. var_names names columns expressions like proteins genes argument origin_data.","code":""},{"path":"/reference/NBF_vis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Neighborhood-Based Featurization Visualization — NBF_vis","text":"interactive shiny app UMAP embeddings.","code":""},{"path":"/reference/build_network.html","id":null,"dir":"Reference","previous_headings":"","what":"Build Networks from Coordinates — build_network","title":"Build Networks from Coordinates — build_network","text":"function used derive network object coordinate matrix.","code":""},{"path":"/reference/build_network.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build Networks from Coordinates — build_network","text":"","code":"build_network(net, center_index, edge)"},{"path":"/reference/build_network.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build Networks from Coordinates — build_network","text":"net data frame containing columns named x_center y_center, x y coordinates cells, respectively. center_index index name center cell. edge maximal length edge exist.","code":""},{"path":"/reference/build_network.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build Networks from Coordinates — build_network","text":"network object.","code":""},{"path":"/reference/centralities.html","id":null,"dir":"Reference","previous_headings":"","what":"A Function Calculating Network Centralities Statistics — centralities","title":"A Function Calculating Network Centralities Statistics — centralities","text":"function used calculate network statistics respect one specific vertex  network, various centralities.","code":""},{"path":"/reference/centralities.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A Function Calculating Network Centralities Statistics — centralities","text":"","code":"centralities(g, center_index)"},{"path":"/reference/centralities.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"A Function Calculating Network Centralities Statistics — centralities","text":"g network object (g stands \"graph\"). center_index index name vertex (center cell) whose centralities interested .","code":""},{"path":"/reference/grid2edgelist.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the Edgelist from Coordinates — grid2edgelist","title":"Get the Edgelist from Coordinates — grid2edgelist","text":"function used get edgelist network coordinates cells.  network built according coordinates cells.  Edges generated nodes whose distance smaller equal given length.  function used function build_network","code":""},{"path":"/reference/grid2edgelist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the Edgelist from Coordinates — grid2edgelist","text":"","code":"grid2edgelist(grid, edge)"},{"path":"/reference/grid2edgelist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the Edgelist from Coordinates — grid2edgelist","text":"grid coordinates cells. includes least three columns, x_center, y_center, id. x_center x coordinates cells, y_center y_coordinates cells. id indices thec cells. edge maximal length edge network.","code":""},{"path":"/reference/grid2edgelist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the Edgelist from Coordinates — grid2edgelist","text":"edgelist network generated coordinates cells using given maximal edge length.","code":""},{"path":"/reference/grid2edgelist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get the Edgelist from Coordinates — grid2edgelist","text":"output edgelist network.","code":""},{"path":"/reference/network_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Network Statistics Matrix — network_matrix","title":"Calculate Network Statistics Matrix — network_matrix","text":"function aimed calculating network statistics neighborhood  network cell. output network statistics matrix.","code":""},{"path":"/reference/network_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Network Statistics Matrix — network_matrix","text":"","code":"network_matrix(   coordinate,   index,   radius = NULL,   NN = NULL,   edge,   fun = centralities,   length_output = 30,   name_output = NULL )"},{"path":"/reference/network_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Network Statistics Matrix — network_matrix","text":"coordinate data frame containing cell indices x y coordinates labeled index, x_center y_center, respectively. radius maximal radius length neighborhood. cells whose distance center cell larger length  included neighborhood. NN number nearest neighbors. NULL, nearest NN cells included neighborhood. edge maximal length network edge. fun function calculates statistics network.  Two arguments supposed function. first one network object  second one index indicating statistics vertex (cell) calculated.  default function centralities. length_output number statistics calculated argument fun.  default value 30, number statistics centralities function package. name_output names statistics calculated argument fun.","code":""},{"path":"/reference/network_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Network Statistics Matrix — network_matrix","text":"network statistics matrix, rows representing network statistics neighborhood network single cell.","code":""},{"path":"/reference/pca_.html","id":null,"dir":"Reference","previous_headings":"","what":"Principal Component Analysis function used in the function quantile_matrix — pca_","title":"Principal Component Analysis function used in the function quantile_matrix — pca_","text":"function used Principal Component Analysis(PCA)  function quantile_matrix package. uses prcomp function PCA.","code":""},{"path":"/reference/pca_.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Principal Component Analysis function used in the function quantile_matrix — pca_","text":"","code":"pca_(data, pca_threshold = 0.9, ...)"},{"path":"/reference/pca_.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Principal Component Analysis function used in the function quantile_matrix — pca_","text":"data input data matrix, containing expression information like proteins genes.  things like indices coordinates included. pca_threshold minimal percentage explained variance Principal Component Analysis.  default value 0.9. ... parameters passed prcomp function.","code":""},{"path":"/reference/quantiles_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile Matrix Function — quantiles_matrix","title":"Quantile Matrix Function — quantiles_matrix","text":"function used get neighborhood quantile matrix raw spatial omics dataset.","code":""},{"path":"/reference/quantiles_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile Matrix Function — quantiles_matrix","text":"","code":"quantiles_matrix(   data,   coordinate,   index,   distance = NULL,   NN = NULL,   min_percentile = 0.1,   max_percentile = 0.9,   quantile_number = 21,   method = pca_,   ... )"},{"path":"/reference/quantiles_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile Matrix Function — quantiles_matrix","text":"data data frame containing expression information cell, like proteins, genes.  data frame contains columns except expressions, like indices cells coordinates cells. coordinate coordinates corresponding cells data argument.  includes two columns specific names, first x coordinates cells, second y coordinates cells. index indices corresponding cells data argument. distance maximal radius neighborbood center cell.  try find neighborhood particular cell, cell called center cell. cells given raidus center cell included center cell's neighborhood.  least one NN dustance arguments specified. NN number nearest neighbors. default value NULL.  value NULL, nearest neighborhood method applied determine neighborhood cell  given number closest cells included center cell's neighborhood.  least one NN dustance arguments specified. min_percentile minimal percentile. default value 0.1. max_percentile maximal percentile. default value 0.9. quantile_number number quantiles variable.  used function seq(min_percentile, max_percentile, length.= quantile_numbers) get given number quantiles. method dimension reduction function data argument.  default method Principal Component Analysis using pca_ function package. ... parameters passed method argument.","code":""},{"path":"/reference/quantiles_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile Matrix Function — quantiles_matrix","text":"neighborhood quantile matrix. row represents quantiles reduced features neighborhood one cell. first number cells corresponding neighborhood, used check whether abnormal neighborhoods.","code":""},{"path":"/reference/quantiles_matrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantile Matrix Function — quantiles_matrix","text":"spatial omics dataset divided two parts, expression matrix coordinates.  Firstly, dimension reduction method like Principle Component Analysis applied expression matrix.  , neighborhood cell extracted according distance .  Next, neighborhood, tens quantiles principal component calculated, treated  neighborhood information vector cell.  final output neighborhood quantile matrix, row neighborhood quantile vector  principal components cell.","code":""}]
